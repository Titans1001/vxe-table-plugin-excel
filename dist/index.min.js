!function(e,t){if("function"==typeof define&&define.amd)define("vxe-table-plugin-excel",["exports","xe-utils"],t);else if("undefined"!=typeof exports)t(exports,require("xe-utils"));else{var r={exports:{}};t(r.exports,e.XEUtils),e.VXETablePluginExcel=r.exports.default}}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:this,function(e,p){"use strict";var t;function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.VXETablePluginVirtualTree=e.EXCEL_METHODS_NAME=void 0,p=(t=p)&&t.__esModule?t:{default:t};var i,r,c={trigger:"dblclick",mode:"cell",showIcon:!1,showStatus:!1},d={header:{options:[[{code:"exportAll",name:"隐藏列"},{code:"exportAll",name:"取消所有隐藏"}]]},body:{options:[[{code:"clip",name:"剪贴(Ctrl+X)"},{code:"copy",name:"复制(Ctrl+C)"},{code:"paste",name:"粘贴(Ctrl+V)"}],[{code:"insert",name:"插入"},{code:"remove",name:"删除"},{code:"clearData",name:"清除内容(Del)"}],[{code:"filter",name:"筛选",children:[{code:"clearFilter",name:"清除筛选"},{code:"filterSelect",name:"按所选单元格的值筛选"}]},{code:"sort",name:"排序",children:[{code:"clearSort",name:"清除排序"},{code:"sortAsc",name:"升序"},{code:"sortDesc",name:"倒序"}]}],[{code:"exportAll",name:"导出数据.csv"}]]}};e.EXCEL_METHODS_NAME=i,(r=i||(e.EXCEL_METHODS_NAME=i={})).CONTEXT_MENU_CLICK_EVENT="contextMenuClickEvent",r.CELL_SPAN_METHOD="cellSpanMethod";var u={cell:{autofocus:".vxe-textarea--inner",renderEdit:function(e,t,r,n){var a=n.$excel.excelStore.uploadRows,o=r.row,l=r.column,s=l.model;return[e("div",{class:"vxe-textarea vxe-excel-cell",style:{height:"".concat(l.renderHeight,"px")}},[e("textarea",{class:"vxe-textarea--inner",style:{width:"".concat(l.renderWidth,"px")},domProps:{value:s.value},on:{input:function(e){var t=e.target;s.update=!0,s.value=t.value,t.scrollHeight>t.offsetHeight&&(-1===a.indexOf(o)?t.style.width="".concat(t.offsetWidth+20,"px"):t.style.height="".concat(t.scrollHeight,"px"))},change:function(){-1===a.indexOf(o)&&a.push(o)},keydown:function(e){var t,r,n=e.target;if(e.altKey&&13===e.keyCode){e.preventDefault(),e.stopPropagation();var a=(r={text:"",start:0,end:0},(t=n).setSelectionRange&&(r.start=t.selectionStart,r.end=t.selectionEnd),r),o=a.end,l=n.value;l="".concat(l.slice(0,o),"\n").concat(l.slice(o,l.length)),n.value=l,s.update=!0,s.value=l,n.style.height="".concat(24*(Math.floor(n.offsetHeight/24)+1),"px"),setTimeout(function(){var e,t;a.start=a.end=++o,t=a,(e=n).setSelectionRange&&(e.focus(),e.setSelectionRange(t.start,t.end))})}}}})])]},renderCell:function(e,t,r){var n=r.row,a=r.column;return[e("span",{domProps:{innerHTML:p.default.escape(p.default.get(n,a.property)).replace(/\n/g,"<br>")}})]}}},n={install:function(e){var t,r,n,a,o,l=e.renderer;if("v1"===e.v)throw new Error("[vxe-table-plugin-virtual-tree] >= V2 version is required.");l.mixin(u),n=(t=e).Vue,a=t.Table,o={name:"VxeExcel",props:{columns:Array},data:function(){var e={excelStore:{uploadRows:[]},mergeStore:{colList:[],rowList:[]}};return e},computed:{tableProps:function(){var e=this.$props,t=this.editConfig;return p.default.assign({},e,{border:!0,resizable:!0,showOverflow:null,contextMenu:d,mouseConfig:{selected:!0,checked:!0},keyboardConfig:{isArrow:!0,isDel:!0,isEnter:!0,isTab:!0,isCut:!0,isEdit:!0},editConfig:Object.assign({},c,t),optimization:{scrollX:{gt:100},scrollY:{gt:100}}})}},watch:{columns:function(e){this.loadColumn(e)}},mounted:function(){var e=this.columns;e&&e.length&&this.loadColumn(this.columns)},render:function(e){var t=this.$slots,r=this.$listeners;return e("vxe-table",{class:"vxe-excel",props:this.tableProps,on:p.default.assign({},r,{"context-menu-click":this.contextMenuClickEvent}),ref:"xTable"},t.default)},methods:(s(r={},i.CONTEXT_MENU_CLICK_EVENT,function(e,t){var r=e.menu,n=e.row,a=e.column,o=this.$refs.xTable,l=a.property;switch(r.code){case"clip":o.handleCopyed(!0,t);break;case"copy":o.handleCopyed(!1,t);break;case"paste":o.handlePaste(t);break;case"insert":o.insertAt({},n);break;case"remove":o.remove(n);break;case"clearData":o.clearData(n,l);break;case"clearFilter":o.clearFilter(a);break;case"filterSelect":o.filter(l).then(function(e){if(e.length){var t=e[0];t.data=p.default.get(n,l),t.checked=!0}}).then(function(){return o.updateData()});break;case"clearSort":o.clearSort();break;case"sortAsc":o.sort(l,"asc");break;case"sortDesc":o.sort(l,"desc");break;case"exportAll":o.exportData({isHeader:!1});break;case"merge":var s=o.getMouseCheckeds(),i=s.columns,c=s.rows,d=this.mergeStore,u=d.colList,f=d.rowList;c.length&&i.length&&(c.forEach(function(e){return-1===f.indexOf(e)?f.push(e):0}),i.forEach(function(e){return-1===u.indexOf(e)?u.push(e):0}))}}),s(r,i.CELL_SPAN_METHOD,function(e){var t=e.row,r=e.$rowIndex,n=e.column,a=e.data,o=this.mergeStore,l=o.colList,s=o.rowList;if(-1<l.indexOf(n)){var i=a[r-1],c=a[r+1],d=-1<s.indexOf(t);if(i&&d&&-1<s.indexOf(i))return{rowspan:0,colspan:0};var u=1;if(d)for(;c&&-1<s.indexOf(c);)c=a[++u+r];if(1<u)return{rowspan:u,colspan:1}}}),r)},p.default.assign(o.props,a.props),p.default.each(a.methods,function(e,t){o.methods[t]=function(){return this.$refs.xTable[t].apply(this.$refs.xTable,arguments)}}),n.component(o.name,o)}};e.VXETablePluginVirtualTree=n,"undefined"!=typeof window&&window.VXETable&&window.VXETable.use(n);var a=n;e.default=a});