!function(e,t){if("function"==typeof define&&define.amd)define("vxe-table-plugin-excel",[],t);else if("undefined"!=typeof exports)t();else{t(),e.VXETablePluginExcel={}.default}}(this,function(){"use strict";var e;exports.__esModule=!0;var t,r,p=require("xe-utils"),o={trigger:"dblclick",mode:"cell",showIcon:!1,showStatus:!1},n={header:{options:[[{code:"exportAll",name:"隐藏列"},{code:"exportAll",name:"取消所有隐藏"}]]},body:{options:[[{code:"clip",name:"剪贴(Ctrl+X)"},{code:"copy",name:"复制(Ctrl+C)"},{code:"paste",name:"粘贴(Ctrl+V)"}],[{code:"insert",name:"插入"},{code:"remove",name:"删除"},{code:"clearData",name:"清除内容(Del)"}],[{code:"filter",name:"筛选",children:[{code:"clearFilter",name:"清除筛选"},{code:"filterSelect",name:"按所选单元格的值筛选"}]},{code:"sort",name:"排序",children:[{code:"clearSort",name:"清除排序"},{code:"sortAsc",name:"升序"},{code:"sortDesc",name:"倒序"}]}],[{code:"exportAll",name:"导出数据.csv"}]]}};(r=t=exports.EXCEL_METHODS_NAME||(exports.EXCEL_METHODS_NAME={})).CONTEXT_MENU_CLICK_EVENT="contextMenuClickEvent",r.CELL_SPAN_METHOD="cellSpanMethod",exports.Excel={name:"VxeExcel",props:{columns:Array},data:function(){var e={excelStore:{uploadRows:[]},mergeStore:{colList:[],rowList:[]}};return e},computed:{tableProps:function(){var e=this.$props,t=this.editConfig;return p.default.assign({},e,{border:!0,resizable:!0,showOverflow:null,contextMenu:n,mouseConfig:{selected:!0,checked:!0},keyboardConfig:{isArrow:!0,isDel:!0,isTab:!0,isCut:!0,isEdit:!0},editConfig:Object.assign({},o,t),optimization:{scrollX:{gt:100,oSize:6,rSize:20},scrollY:{gt:100,oSize:30,rSize:80}}})}},watch:{columns:function(e){this.loadColumn(e)}},mounted:function(){var e=this.columns;e&&e.length&&this.loadColumn(this.columns)},render:function(e){var t=this,r=t.$slots,o=t.$listeners;return e("vxe-table",{class:"vxe-excel",props:t.tableProps,on:p.default.assign({},o,{"context-menu-click":this.contextMenuClickEvent}),ref:"xTable"},r.default)},methods:(e={},e[t.CONTEXT_MENU_CLICK_EVENT]=function(e,t){var r=e.menu,o=e.row,n=e.column,a=this.$refs.xTable,l=n.property;switch(r.code){case"clip":a.handleCopyed(!0,t);break;case"copy":a.handleCopyed(!1,t);break;case"paste":a.handlePaste(t);break;case"insert":a.insertAt({},o);break;case"remove":a.remove(o);break;case"clearData":a.clearData(o,l);break;case"clearFilter":a.clearFilter(n);break;case"filterSelect":a.filter(l).then(function(e){if(e.length){var t=e[0];t.data=p.default.get(o,l),t.checked=!0}}).then(function(){return a.updateData()});break;case"clearSort":a.clearSort();break;case"sortAsc":a.sort(l,"asc");break;case"sortDesc":a.sort(l,"desc");break;case"exportAll":a.exportCsv({isHeader:!1});break;case"merge":var s=a.getMouseCheckeds(),c=s.columns,i=s.rows,d=this.mergeStore,u=d.colList,f=d.rowList;i.length&&c.length&&(i.forEach(function(e){return-1===f.indexOf(e)?f.push(e):0}),c.forEach(function(e){return-1===u.indexOf(e)?u.push(e):0}))}},e[t.CELL_SPAN_METHOD]=function(e){var t=e.row,r=e.$rowIndex,o=e.column,n=e.data,a=this.mergeStore,l=a.colList,s=a.rowList;if(-1<l.indexOf(o)){var c=n[r-1],i=n[r+1],d=-1<s.indexOf(t);if(c&&d&&-1<s.indexOf(c))return{rowspan:0,colspan:0};var u=1;if(d)for(;i&&-1<s.indexOf(i);)i=n[++u+r];if(1<u)return{rowspan:u,colspan:1}}},e)};var a={cell:{autofocus:".vxe-textarea",renderEdit:function(e,t,r,o){var n=o.$excel.excelStore.uploadRows,a=r.row,l=r.column,s=l.model;return[e("div",{class:"vxe-input--wrapper vxe-excel-cell",style:{height:l.renderHeight-1+"px"}},[e("textarea",{class:"vxe-textarea",style:{width:l.renderWidth+"px"},domProps:{value:s.value},on:{input:function(e){var t=e.target;s.update=!0,s.value=t.value,t.scrollHeight>t.offsetHeight&&(-1===n.indexOf(a)?t.style.width=t.offsetWidth+20+"px":t.style.height=t.scrollHeight+"px")},change:function(e){-1===n.indexOf(a)&&n.push(a)},keydown:function(e){var t=e.target;if(e.altKey&&13===e.keyCode){e.preventDefault(),e.stopPropagation();var r=function(e){var t={text:"",start:0,end:0};return e.setSelectionRange&&(t.start=e.selectionStart,t.end=e.selectionEnd),t}(t),o=r.end,n=t.value;n=n.slice(0,o)+"\n"+n.slice(o,n.length),t.value=n,s.update=!0,s.value=n,t.style.height=24*(Math.floor(t.offsetHeight/24)+1)+"px",setTimeout(function(){r.start=r.end=++o,function(e,t){e.setSelectionRange&&(e.focus(),e.setSelectionRange(t.start,t.end))}(t,r)})}}}})])]},renderCell:function(e,t,r){var o=r.row,n=r.column;return[e("span",{domProps:{innerHTML:p.default.escape(p.default.get(o,n.property)).replace(/\n/g,"<br>")}})]}}};exports.VXETablePluginExcel={install:function(e){var t=e.Vue,r=e.Table,o=e.renderer;if("v1"===e.v)throw new Error("[vxe-table-plugin-excel] >= V2 version is required.");p.default.assign(exports.Excel.props,r.props),p.default.each(r.methods,function(e,t){exports.Excel.methods[t]=function(){return this.$refs.xTable[t].apply(this.$refs.xTable,arguments)}}),o.mixin(a),t.component(exports.Excel.name,exports.Excel)}},"undefined"!=typeof window&&window.VXETable&&window.VXETable.use(exports.VXETablePluginExcel),exports.default=exports.VXETablePluginExcel});