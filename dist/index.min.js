!function(e,t){if("function"==typeof define&&define.amd)define("vxe-table-plugin-excel",["exports","xe-utils"],t);else if("undefined"!=typeof exports)t(exports,require("xe-utils"));else{var a={exports:{}};t(a.exports,e.XEUtils),e.VXETablePluginExcel=a.exports.default}}(this,function(e,c){"use strict";var t;Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.VXETablePluginExcel=void 0,c=(t=c)&&t.__esModule?t:{default:t};var a={trigger:"dblclick",mode:"cell",showIcon:!1,showStatus:!1},o={header:{options:[[{code:"exportAll",name:"隐藏列"},{code:"exportAll",name:"取消所有隐藏"}]]},body:{options:[[{code:"clip",name:"剪贴(Ctrl+X)"},{code:"copy",name:"复制(Ctrl+C)"},{code:"paste",name:"粘贴(Ctrl+V)"}],[{code:"insert",name:"插入"},{code:"remove",name:"删除"},{code:"clearData",name:"清除内容(Del)"}],[{code:"filter",name:"筛选",children:[{code:"clearFilter",name:"清除筛选"},{code:"filterSelect",name:"按所选单元格的值筛选"}]},{code:"sort",name:"排序",children:[{code:"clearSort",name:"清除排序"},{code:"sortAsc",name:"升序"},{code:"sortDesc",name:"倒序"}]}],[{code:"exportAll",name:"导出数据.csv"}]]}},r={name:"VxeExcel",props:{columns:Array},data:function(){return{excelStore:{uploadRows:[]}}},computed:{tableProps:function(){var e=this.$props,t=this.editConfig;return c.default.assign({},e,{border:!0,resizable:!0,showOverflow:null,contextMenu:o,mouseConfig:{selected:!0,checked:!0},keyboardConfig:{isArrow:!0,isDel:!0,isTab:!0,isCut:!0,isEdit:!0},editConfig:Object.assign({},a,t),optimization:{scrollX:{gt:100,oSize:6,rSize:20},scrollY:{gt:100,oSize:30,rSize:80}}})}},watch:{columns:function(e){this.loadColumn(e)}},mounted:function(){var e=this.columns;e&&e.length&&this.loadColumn(this.columns)},render:function(e){var t=this.$slots,a=this.$listeners;return e("vxe-table",{class:"vxe-excel",props:this.tableProps,on:c.default.assign({},a,{"context-menu-click":this.contextMenuClickEvent}),ref:"xTable"},t.default)},methods:{contextMenuClickEvent:function(e,t){var a=e.menu,o=e.row,r=e.column,n=this.$refs.xTable,l=r.property;switch(a.code){case"clip":n.handleCopyed(!0,t);break;case"copy":n.handleCopyed(!1,t);break;case"paste":n.handlePaste(t);break;case"insert":n.insertAt({},o);break;case"remove":n.remove(o);break;case"clearData":n.clearData(o,l);break;case"clearFilter":n.clearFilter(r);break;case"filterSelect":n.filter(l).then(function(e){if(e.length){var t=e[0];t.data=c.default.get(o,l),t.checked=!0}}).then(function(){return n.updateData()});break;case"clearSort":n.clearSort();break;case"sortAsc":n.sort(l,"asc");break;case"sortDesc":n.sort(l,"desc");break;case"exportAll":n.exportCsv({isHeader:!1})}}}};var n={cell:{autofocus:".vxe-textarea",renderEdit:function(e,t,a,o){var r=o.$excel.excelStore.uploadRows,n=a.row,l=a.column,c=l.model;return[e("div",{class:"vxe-input--wrapper vxe-excel-cell",style:{height:"".concat(l.renderHeight-1,"px")}},[e("textarea",{class:"vxe-textarea",style:{width:"".concat(l.renderWidth,"px")},domProps:{value:c.value},on:{input:function(e){var t=e.target;c.update=!0,c.value=t.value,t.scrollHeight>t.offsetHeight&&(-1===r.indexOf(n)?t.style.width="".concat(t.offsetWidth+20,"px"):t.style.height="".concat(t.scrollHeight,"px"))},change:function(e){-1===r.indexOf(n)&&r.push(n)},keydown:function(e){var t=e.target;if(e.altKey&&13===e.keyCode){e.preventDefault(),e.stopPropagation();var a=function(e){var t={text:"",start:0,end:0};if(e.setSelectionRange)t.start=e.selectionStart,t.end=e.selectionEnd,t.text=t.start!==t.end?e.value.substring(t.start,t.end):"";else if(document.selection){var a=0,o=document.selection.createRange(),r=document.body.createTextRange();for(r.moveToElementText(e),t.text=o.text,t.bookmark=o.getBookmark();r.compareEndPoints("StartToStart",o)<0&&0!==o.moveStart("character",-1);a++)"\n"===e.value.charAt(a)&&a++;t.start=a,t.end=t.text.length+t.start}return t}(t),o=a.end,r=t.value;r="".concat(r.slice(0,o),"\n").concat(r.slice(o,r.length)),t.value=r,c.update=!0,c.value=r,t.style.height="".concat(24*(Math.floor(t.offsetHeight/24)+1),"px"),setTimeout(function(){a.start=a.end=++o,function(e,t){if(e.setSelectionRange)e.focus(),e.setSelectionRange(t.start,t.end);else if(e.createTextRange){var a=e.createTextRange();e.value.length===t.start?a.collapse(!1):a.moveToBookmark(t.bookmark),a.select()}}(t,a)})}}}})])]},renderCell:function(e,t,a){var o=a.row,r=a.column;return[e("span",{domProps:{innerHTML:c.default.escape(c.default.get(o,r.property)).replace(/\n/g,"<br>")}})]}}},l={install:function(e){var t=e.Vue,a=e.Table,o=e.renderer;if("v1"===e.v)throw new Error("[vxe-table] >= V2 version is required.");c.default.assign(r.props,a.props),c.default.each(a.methods,function(e,t){r.methods[t]=function(){return this.$refs.xTable[t].apply(this.$refs.xTable[t],arguments)}}),o.mixin(n),t.component(r.name,r)}};e.VXETablePluginExcel=l,"undefined"!=typeof window&&window.VXETable&&window.VXETable.use(l);var s=l;e.default=s});