"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = exports.VXETablePluginExcel = exports.Excel = exports.EXCEL_METHODS_NAME = void 0;

var _xeUtils = _interopRequireDefault(require("xe-utils/methods/xe-utils"));

var _methods;

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var excelEditConfig = {
  trigger: 'dblclick',
  mode: 'cell',
  showIcon: false,
  showStatus: false
};
var excelContextMenu = {
  header: {
    options: [[{
      code: 'exportAll',
      name: '隐藏列'
    }, {
      code: 'exportAll',
      name: '取消所有隐藏'
    }]]
  },
  body: {
    options: [[{
      code: 'clip',
      name: '剪贴(Ctrl+X)'
    }, {
      code: 'copy',
      name: '复制(Ctrl+C)'
    }, {
      code: 'paste',
      name: '粘贴(Ctrl+V)'
    }], [{
      code: 'insert',
      name: '插入'
    }, {
      code: 'remove',
      name: '删除'
    }, {
      code: 'clearData',
      name: '清除内容(Del)'
    }], // [
    //   {
    //     code: 'merge',
    //     name: '合并单元格'
    //   }
    // ],
    [{
      code: 'filter',
      name: '筛选',
      children: [{
        code: 'clearFilter',
        name: '清除筛选'
      }, {
        code: 'filterSelect',
        name: '按所选单元格的值筛选'
      }]
    }, {
      code: 'sort',
      name: '排序',
      children: [{
        code: 'clearSort',
        name: '清除排序'
      }, {
        code: 'sortAsc',
        name: '升序'
      }, {
        code: 'sortDesc',
        name: '倒序'
      }]
    }], [{
      code: 'exportAll',
      name: '导出数据.csv'
    }]]
  }
};
var EXCEL_METHODS_NAME;
exports.EXCEL_METHODS_NAME = EXCEL_METHODS_NAME;

(function (EXCEL_METHODS_NAME) {
  EXCEL_METHODS_NAME["CONTEXT_MENU_CLICK_EVENT"] = "contextMenuClickEvent";
  EXCEL_METHODS_NAME["CELL_SPAN_METHOD"] = "cellSpanMethod";
})(EXCEL_METHODS_NAME || (exports.EXCEL_METHODS_NAME = EXCEL_METHODS_NAME = {}));

var Excel = {
  name: 'VxeExcel',
  props: {
    columns: Array
  },
  data: function data() {
    var data = {
      excelStore: {
        uploadRows: []
      },
      mergeStore: {
        colList: [],
        rowList: []
      }
    };
    return data;
  },
  computed: {
    tableProps: function tableProps() {
      var $props = this.$props,
          editConfig = this.editConfig;
      return _xeUtils["default"].assign({}, $props, {
        border: true,
        resizable: true,
        showOverflow: null,
        // spanMethod: this.cellSpanMethod,
        contextMenu: excelContextMenu,
        mouseConfig: {
          selected: true,
          checked: true
        },
        keyboardConfig: {
          isArrow: true,
          isDel: true,
          isTab: true,
          isCut: true,
          isEdit: true
        },
        editConfig: Object.assign({}, excelEditConfig, editConfig),
        optimization: {
          scrollX: {
            gt: 100,
            oSize: 6,
            rSize: 20
          },
          scrollY: {
            gt: 100,
            oSize: 30,
            rSize: 80
          }
        }
      });
    }
  },
  watch: {
    columns: function columns(value) {
      this.loadColumn(value);
    }
  },
  mounted: function mounted() {
    var columns = this.columns;

    if (columns && columns.length) {
      this.loadColumn(this.columns);
    }
  },
  render: function render(h) {
    var $slots = this.$slots,
        $listeners = this.$listeners,
        tableProps = this.tableProps;
    return h('vxe-table', {
      "class": 'vxe-excel',
      props: tableProps,
      on: _xeUtils["default"].assign({}, $listeners, {
        'context-menu-click': this.contextMenuClickEvent
      }),
      ref: 'xTable'
    }, $slots["default"]);
  },
  methods: (_methods = {}, _defineProperty(_methods, EXCEL_METHODS_NAME.CONTEXT_MENU_CLICK_EVENT, function (_ref, evnt) {
    var menu = _ref.menu,
        row = _ref.row,
        column = _ref.column;
    var $table = this.$refs.xTable;
    var property = column.property;

    switch (menu.code) {
      case 'clip':
        $table.handleCopyed(true, evnt);
        break;

      case 'copy':
        $table.handleCopyed(false, evnt);
        break;

      case 'paste':
        $table.handlePaste(evnt);
        break;

      case 'insert':
        $table.insertAt({}, row);
        break;

      case 'remove':
        $table.remove(row);
        break;

      case 'clearData':
        $table.clearData(row, property);
        break;

      case 'clearFilter':
        $table.clearFilter(column);
        break;

      case 'filterSelect':
        $table.filter(property).then(function (options) {
          if (options.length) {
            var option = options[0];
            option.data = _xeUtils["default"].get(row, property);
            option.checked = true;
          }
        }).then(function () {
          return $table.updateData();
        });
        break;

      case 'clearSort':
        $table.clearSort();
        break;

      case 'sortAsc':
        $table.sort(property, 'asc');
        break;

      case 'sortDesc':
        $table.sort(property, 'desc');
        break;

      case 'exportAll':
        $table.exportCsv({
          isHeader: false
        });
        break;

      case 'merge':
        var _$table$getMouseCheck = $table.getMouseCheckeds(),
            columns = _$table$getMouseCheck.columns,
            rows = _$table$getMouseCheck.rows;

        var _this$mergeStore = this.mergeStore,
            colList = _this$mergeStore.colList,
            rowList = _this$mergeStore.rowList;

        if (rows.length && columns.length) {
          rows.forEach(function (row) {
            return rowList.indexOf(row) === -1 ? rowList.push(row) : 0;
          });
          columns.forEach(function (column) {
            return colList.indexOf(column) === -1 ? colList.push(column) : 0;
          });
        }

        break;
    }
  }), _defineProperty(_methods, EXCEL_METHODS_NAME.CELL_SPAN_METHOD, function (params) {
    var row = params.row,
        $rowIndex = params.$rowIndex,
        column = params.column,
        data = params.data;
    var _this$mergeStore2 = this.mergeStore,
        colList = _this$mergeStore2.colList,
        rowList = _this$mergeStore2.rowList;

    if (colList.indexOf(column) > -1) {
      var prevRow = data[$rowIndex - 1];
      var nextRow = data[$rowIndex + 1];
      var isMerged = rowList.indexOf(row) > -1;

      if (prevRow && isMerged && rowList.indexOf(prevRow) > -1) {
        return {
          rowspan: 0,
          colspan: 0
        };
      } else {
        var countRowspan = 1;

        if (isMerged) {
          while (nextRow && rowList.indexOf(nextRow) > -1) {
            nextRow = data[++countRowspan + $rowIndex];
          }
        }

        if (countRowspan > 1) {
          return {
            rowspan: countRowspan,
            colspan: 1
          };
        }
      }
    }
  }), _methods)
};
exports.Excel = Excel;
var rowHeight = 24;

function getCursorPosition(textarea) {
  var rangeData = {
    text: '',
    start: 0,
    end: 0
  };

  if (textarea.setSelectionRange) {
    rangeData.start = textarea.selectionStart;
    rangeData.end = textarea.selectionEnd;
  }

  return rangeData;
}

function setCursorPosition(textarea, rangeData) {
  if (textarea.setSelectionRange) {
    textarea.focus();
    textarea.setSelectionRange(rangeData.start, rangeData.end);
  }
}
/**
 * 渲染函数
 */


var renderMap = {
  cell: {
    autofocus: '.vxe-textarea',
    renderEdit: function renderEdit(h, editRender, params, _ref2) {
      var $excel = _ref2.$excel;
      var excelStore = $excel.excelStore;
      var uploadRows = excelStore.uploadRows;
      var row = params.row,
          column = params.column;
      var model = column.model;
      return [h('div', {
        "class": 'vxe-input--wrapper vxe-excel-cell',
        style: {
          height: "".concat(column.renderHeight - 1, "px")
        }
      }, [h('textarea', {
        "class": 'vxe-textarea',
        style: {
          width: "".concat(column.renderWidth, "px")
        },
        domProps: {
          value: model.value
        },
        on: {
          input: function input(evnt) {
            var inpElem = evnt.target;
            model.update = true;
            model.value = inpElem.value;

            if (inpElem.scrollHeight > inpElem.offsetHeight) {
              if (uploadRows.indexOf(row) === -1) {
                inpElem.style.width = "".concat(inpElem.offsetWidth + 20, "px");
              } else {
                inpElem.style.height = "".concat(inpElem.scrollHeight, "px");
              }
            }
          },
          change: function change(evnt) {
            if (uploadRows.indexOf(row) === -1) {
              uploadRows.push(row);
            }
          },
          keydown: function keydown(evnt) {
            var inpElem = evnt.target;

            if (evnt.altKey && evnt.keyCode === 13) {
              evnt.preventDefault();
              evnt.stopPropagation();
              var rangeData = getCursorPosition(inpElem);
              var pos = rangeData.end;
              var cellValue = inpElem.value;
              cellValue = "".concat(cellValue.slice(0, pos), "\n").concat(cellValue.slice(pos, cellValue.length));
              inpElem.value = cellValue;
              model.update = true;
              model.value = cellValue;
              inpElem.style.height = "".concat((Math.floor(inpElem.offsetHeight / rowHeight) + 1) * rowHeight, "px");
              setTimeout(function () {
                rangeData.start = rangeData.end = ++pos;
                setCursorPosition(inpElem, rangeData);
              });
            }
          }
        }
      })])];
    },
    renderCell: function renderCell(h, editRender, params) {
      var row = params.row,
          column = params.column;
      return [h('span', {
        domProps: {
          innerHTML: _xeUtils["default"].escape(_xeUtils["default"].get(row, column.property)).replace(/\n/g, '<br>')
        }
      })];
    }
  }
};
/**
 * 基于 vxe-table 表格的增强插件，实现简单的 Excel 表格
 */

var VXETablePluginExcel = {
  install: function install(xtable) {
    var Vue = xtable.Vue,
        Table = xtable.Table,
        renderer = xtable.renderer,
        v = xtable.v;

    if (v === 'v1') {
      throw new Error('[vxe-table-plugin-excel] >= V2 version is required.');
    } // 继承 Table


    _xeUtils["default"].assign(Excel.props, Table.props);

    _xeUtils["default"].each(Table.methods, function (cb, name) {
      Excel.methods[name] = function () {
        return this.$refs.xTable[name].apply(this.$refs.xTable, arguments);
      };
    }); // 添加到渲染器


    renderer.mixin(renderMap); // 注册组件

    Vue.component(Excel.name, Excel);
  }
};
exports.VXETablePluginExcel = VXETablePluginExcel;

if (typeof window !== 'undefined' && window.VXETable) {
  window.VXETable.use(VXETablePluginExcel);
}

var _default = VXETablePluginExcel;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnRzIl0sIm5hbWVzIjpbImV4Y2VsRWRpdENvbmZpZyIsInRyaWdnZXIiLCJtb2RlIiwic2hvd0ljb24iLCJzaG93U3RhdHVzIiwiZXhjZWxDb250ZXh0TWVudSIsImhlYWRlciIsIm9wdGlvbnMiLCJjb2RlIiwibmFtZSIsImJvZHkiLCJjaGlsZHJlbiIsIkVYQ0VMX01FVEhPRFNfTkFNRSIsIkV4Y2VsIiwicHJvcHMiLCJjb2x1bW5zIiwiQXJyYXkiLCJkYXRhIiwiZXhjZWxTdG9yZSIsInVwbG9hZFJvd3MiLCJtZXJnZVN0b3JlIiwiY29sTGlzdCIsInJvd0xpc3QiLCJjb21wdXRlZCIsInRhYmxlUHJvcHMiLCIkcHJvcHMiLCJlZGl0Q29uZmlnIiwiWEVVdGlscyIsImFzc2lnbiIsImJvcmRlciIsInJlc2l6YWJsZSIsInNob3dPdmVyZmxvdyIsImNvbnRleHRNZW51IiwibW91c2VDb25maWciLCJzZWxlY3RlZCIsImNoZWNrZWQiLCJrZXlib2FyZENvbmZpZyIsImlzQXJyb3ciLCJpc0RlbCIsImlzVGFiIiwiaXNDdXQiLCJpc0VkaXQiLCJPYmplY3QiLCJvcHRpbWl6YXRpb24iLCJzY3JvbGxYIiwiZ3QiLCJvU2l6ZSIsInJTaXplIiwic2Nyb2xsWSIsIndhdGNoIiwidmFsdWUiLCJsb2FkQ29sdW1uIiwibW91bnRlZCIsImxlbmd0aCIsInJlbmRlciIsImgiLCIkc2xvdHMiLCIkbGlzdGVuZXJzIiwib24iLCJjb250ZXh0TWVudUNsaWNrRXZlbnQiLCJyZWYiLCJtZXRob2RzIiwiQ09OVEVYVF9NRU5VX0NMSUNLX0VWRU5UIiwiZXZudCIsIm1lbnUiLCJyb3ciLCJjb2x1bW4iLCIkdGFibGUiLCIkcmVmcyIsInhUYWJsZSIsInByb3BlcnR5IiwiaGFuZGxlQ29weWVkIiwiaGFuZGxlUGFzdGUiLCJpbnNlcnRBdCIsInJlbW92ZSIsImNsZWFyRGF0YSIsImNsZWFyRmlsdGVyIiwiZmlsdGVyIiwidGhlbiIsIm9wdGlvbiIsImdldCIsInVwZGF0ZURhdGEiLCJjbGVhclNvcnQiLCJzb3J0IiwiZXhwb3J0Q3N2IiwiaXNIZWFkZXIiLCJnZXRNb3VzZUNoZWNrZWRzIiwicm93cyIsImZvckVhY2giLCJpbmRleE9mIiwicHVzaCIsIkNFTExfU1BBTl9NRVRIT0QiLCJwYXJhbXMiLCIkcm93SW5kZXgiLCJwcmV2Um93IiwibmV4dFJvdyIsImlzTWVyZ2VkIiwicm93c3BhbiIsImNvbHNwYW4iLCJjb3VudFJvd3NwYW4iLCJyb3dIZWlnaHQiLCJnZXRDdXJzb3JQb3NpdGlvbiIsInRleHRhcmVhIiwicmFuZ2VEYXRhIiwidGV4dCIsInN0YXJ0IiwiZW5kIiwic2V0U2VsZWN0aW9uUmFuZ2UiLCJzZWxlY3Rpb25TdGFydCIsInNlbGVjdGlvbkVuZCIsInNldEN1cnNvclBvc2l0aW9uIiwiZm9jdXMiLCJyZW5kZXJNYXAiLCJjZWxsIiwiYXV0b2ZvY3VzIiwicmVuZGVyRWRpdCIsImVkaXRSZW5kZXIiLCIkZXhjZWwiLCJtb2RlbCIsInN0eWxlIiwiaGVpZ2h0IiwicmVuZGVySGVpZ2h0Iiwid2lkdGgiLCJyZW5kZXJXaWR0aCIsImRvbVByb3BzIiwiaW5wdXQiLCJpbnBFbGVtIiwidGFyZ2V0IiwidXBkYXRlIiwic2Nyb2xsSGVpZ2h0Iiwib2Zmc2V0SGVpZ2h0Iiwib2Zmc2V0V2lkdGgiLCJjaGFuZ2UiLCJrZXlkb3duIiwiYWx0S2V5Iiwia2V5Q29kZSIsInByZXZlbnREZWZhdWx0Iiwic3RvcFByb3BhZ2F0aW9uIiwicG9zIiwiY2VsbFZhbHVlIiwic2xpY2UiLCJNYXRoIiwiZmxvb3IiLCJzZXRUaW1lb3V0IiwicmVuZGVyQ2VsbCIsImlubmVySFRNTCIsImVzY2FwZSIsInJlcGxhY2UiLCJWWEVUYWJsZVBsdWdpbkV4Y2VsIiwiaW5zdGFsbCIsInh0YWJsZSIsIlZ1ZSIsIlRhYmxlIiwicmVuZGVyZXIiLCJ2IiwiRXJyb3IiLCJlYWNoIiwiY2IiLCJhcHBseSIsImFyZ3VtZW50cyIsIm1peGluIiwiY29tcG9uZW50Iiwid2luZG93IiwiVlhF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Q0FjOUI7O0FBQ0F1QyxJQUFBQSxHQUFHLENBQUNVLFNBQUosQ0FBY3BKLEtBQUssQ0FBQ0osSUFBcEIsRUFBMEJJLEtBQTFCO0FBQ0Q7QUFqQmdDLENBQTVCOzs7QUFvQlAsSUFBSSxPQUFPcUosTUFBUCxLQUFrQixXQUFsQixJQUFpQ0EsTUFBTSxDQUFDQyxRQUE1QyxFQUFzRDtBQUNwREQsRUFBQUEsTUFBTSxDQUFDQyxRQUFQLENBQWdCQyxHQUFoQixDQUFvQmhCLG1CQUFwQjtBQUNEOztlQUVjQSxtQiIsImZpbGUiOiJpbmRleC5jb21tb24uanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgWEVVdGlscyBmcm9tICd4ZS11dGlscy9tZXRob2RzL3hlLXV0aWxzJ1xyXG5pbXBvcnQgVlhFVGFibGUgZnJvbSAndnhlLXRhYmxlL2xpYi92eGUtdGFibGUnXHJcblxyXG5jb25zdCBleGNlbEVkaXRDb25maWcgPSB7XHJcbiAgdHJpZ2dlcjogJ2RibGNsaWNrJyxcclxuICBtb2RlOiAnY2VsbCcsXHJcbiAgc2hvd0ljb246IGZhbHNlLFxyXG4gIHNob3dTdGF0dXM6IGZhbHNlXHJcbn1cclxuXHJcbmNvbnN0IGV4Y2VsQ29udGV4dE1lbnUgPSB7XHJcbiAgaGVhZGVyOiB7XHJcbiAgICBvcHRpb25zOiBbXHJcbiAgICAgIFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICBjb2RlOiAnZXhwb3J0QWxsJyxcclxuICAgICAgICAgIG5hbWU6ICfpmpDol4/liJcnXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBjb2RlOiAnZXhwb3J0QWxsJyxcclxuICAgICAgICAgIG5hbWU6ICflj5bmtojmiYDmnInpmpDol48nXHJcbiAgICAgICAgfVxyXG4gICAgICBdXHJcbiAgICBdXHJcbiAgfSxcclxuICBib2R5OiB7XHJcbiAgICBvcHRpb25zOiBbXHJcbiAgICAgIFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICBjb2RlOiAnY2xpcCcsXHJcbiAgICAgICAgICBuYW1lOiAn5Ymq6LS0KEN0cmwrWCknXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBjb2RlOiAnY29weScsXHJcbiAgICAgICAgICBuYW1lOiAn5aSN5Yi2KEN0cmwrQyknXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBjb2RlOiAncGFzdGUnLFxyXG4gICAgICAgICAgbmFtZTogJ+eymOi0tChDdHJsK1YpJ1xyXG4gICAgICAgIH1cclxuICAgICAgXSxcclxuICAgICAgW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIGNvZGU6ICdpbnNlcnQnLFxyXG4gICAgICAgICAgbmFtZTogJ+aPkuWFpSdcclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIGNvZGU6ICdyZW1vdmUnLFxyXG4gICAgICAgICAgbmFtZTogJ+WIoOmZpCdcclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIGNvZGU6ICdjbGVhckRhdGEnLFxyXG4gICAgICAgICAgbmFtZTogJ+a4hemZpOWGheWuuShEZWwpJ1xyXG4gICAgICAgIH1cclxuICAgICAgXSxcclxuICAgICAgLy8gW1xyXG4gICAgICAvLyAgIHtcclxuICAgICAgLy8gICAgIGNvZGU6ICdtZXJnZScsXHJcbiAgICAgIC8vICAgICBuYW1lOiAn5ZCI5bm25Y2V5YWD5qC8J1xyXG4gICAgICAvLyAgIH1cclxuICAgICAgLy8gXSxcclxuICAgICAgW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIGNvZGU6ICdmaWx0ZXInLFxyXG4gICAgICAgICAgbmFtZTogJ+etm+mAiScsXHJcbiAgICAgICAgICBjaGlsZHJlbjogW1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgY29kZTogJ2NsZWFyRmlsdGVyJyxcclxuICAgICAgICAgICAgICBuYW1lOiAn5riF6Zmk562b6YCJJ1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgY29kZTogJ2ZpbHRlclNlbGVjdCcsXHJcbiAgICAgICAgICAgICAgbmFtZTogJ+aMieaJgOmAieWNleWFg+agvOeahOWAvOetm+mAiSdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgXVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgY29kZTogJ3NvcnQnLFxyXG4gICAgICAgICAgbmFtZTogJ+aOkuW6jycsXHJcbiAgICAgICAgICBjaGlsZHJlbjogW1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgY29kZTogJ2NsZWFyU29ydCcsXHJcbiAgICAgICAgICAgICAgbmFtZTogJ+a4hemZpOaOkuW6jydcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgIGNvZGU6ICdzb3J0QXNjJyxcclxuICAgICAgICAgICAgICBuYW1lOiAn5Y2H5bqPJ1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgY29kZTogJ3NvcnREZXNjJyxcclxuICAgICAgICAgICAgICBuYW1lOiAn5YCS5bqPJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICBdXHJcbiAgICAgICAgfVxyXG4gICAgICBdLFxyXG4gICAgICBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgY29kZTogJ2V4cG9ydEFsbCcsXHJcbiAgICAgICAgICBuYW1lOiAn5a+85Ye65pWw5o2uLmNzdidcclxuICAgICAgICB9XHJcbiAgICAgIF1cclxuICAgIF1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIEVYQ0VMX01FVEhPRFNfTkFNRSB7XHJcbiAgQ09OVEVYVF9NRU5VX0NMSUNLX0VWRU5UID0gJ2NvbnRleHRNZW51Q2xpY2tFdmVudCcsXHJcbiAgQ0VMTF9TUEFOX01FVEhPRCA9ICdjZWxsU3Bhbk1ldGhvZCdcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSB2RXhjZWxEYXRhIHtcclxuICBleGNlbFN0b3JlOiB7XHJcbiAgICB1cGxvYWRSb3dzOiBBcnJheTxhbnk+O1xyXG4gIH1cclxuICBtZXJnZVN0b3JlOiB7XHJcbiAgICBjb2xMaXN0OiBBcnJheTxhbnk+O1xyXG4gICAgcm93TGlzdDogQXJyYXk8YW55PjtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBFeGNlbCA9IHtcclxuICBuYW1lOiAnVnhlRXhjZWwnLFxyXG4gIHByb3BzOiB7XHJcbiAgICBjb2x1bW5zOiBBcnJheVxyXG4gIH0sXHJcbiAgZGF0YSAoKSB7XHJcbiAgICBsZXQgZGF0YTogdkV4Y2VsRGF0YSA9ICB7XHJcbiAgICAgIGV4Y2VsU3RvcmU6IHtcclxuICAgICAgICB1cGxvYWRSb3dzOiBbXVxyXG4gICAgICB9LFxyXG4gICAgICBtZXJnZVN0b3JlOiB7XHJcbiAgICAgICAgY29sTGlzdDogW10sXHJcbiAgICAgICAgcm93TGlzdDogW11cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGRhdGFcclxuICB9LFxyXG4gIGNvbXB1dGVkOiB7XHJcbiAgICB0YWJsZVByb3BzICh0aGlzOiBhbnkpOiBhbnkge1xyXG4gICAgICBsZXQgeyAkcHJvcHMsIGVkaXRDb25maWcgfSA9IHRoaXNcclxuICAgICAgcmV0dXJuIFhFVXRpbHMuYXNzaWduKHt9LCAkcHJvcHMsIHtcclxuICAgICAgICBib3JkZXI6IHRydWUsXHJcbiAgICAgICAgcmVzaXphYmxlOiB0cnVlLFxyXG4gICAgICAgIHNob3dPdmVyZmxvdzogbnVsbCxcclxuICAgICAgICAvLyBzcGFuTWV0aG9kOiB0aGlzLmNlbGxTcGFuTWV0aG9kLFxyXG4gICAgICAgIGNvbnRleHRNZW51OiBleGNlbENvbnRleHRNZW51LFxyXG4gICAgICAgIG1vdXNlQ29uZmlnOiB7IHNlbGVjdGVkOiB0cnVlLCBjaGVja2VkOiB0cnVlIH0sXHJcbiAgICAgICAga2V5Ym9hcmRDb25maWc6IHsgaXNBcnJvdzogdHJ1ZSwgaXNEZWw6IHRydWUsIGlzVGFiOiB0cnVlLCBpc0N1dDogdHJ1ZSwgaXNFZGl0OiB0cnVlIH0sXHJcbiAgICAgICAgZWRpdENvbmZpZzogT2JqZWN0LmFzc2lnbih7fSwgZXhjZWxFZGl0Q29uZmlnLCBlZGl0Q29uZmlnKSxcclxuICAgICAgICBvcHRpbWl6YXRpb246IHtcclxuICAgICAgICAgIHNjcm9sbFg6IHtcclxuICAgICAgICAgICAgZ3Q6IDEwMCxcclxuICAgICAgICAgICAgb1NpemU6IDYsXHJcbiAgICAgICAgICAgIHJTaXplOiAyMFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHNjcm9sbFk6IHtcclxuICAgICAgICAgICAgZ3Q6IDEwMCxcclxuICAgICAgICAgICAgb1NpemU6IDMwLFxyXG4gICAgICAgICAgICByU2l6ZTogODBcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICB9XHJcbiAgfSxcclxuICB3YXRjaDoge1xyXG4gICAgY29sdW1ucyAodGhpczogYW55LCB2YWx1ZTogQXJyYXk8YW55Pikge1xyXG4gICAgICB0aGlzLmxvYWRDb2x1bW4odmFsdWUpXHJcbiAgICB9XHJcbiAgfSxcclxuICBtb3VudGVkICh0aGlzOiBhbnkpIHtcclxuICAgIGxldCB7IGNvbHVtbnMgfSA9IHRoaXNcclxuICAgIGlmIChjb2x1bW5zICYmIGNvbHVtbnMubGVuZ3RoKSB7XHJcbiAgICAgIHRoaXMubG9hZENvbHVtbih0aGlzLmNvbHVtbnMpXHJcbiAgICB9XHJcbiAgfSxcclxuICByZW5kZXIgKHRoaXM6IGFueSwgaDogRnVuY3Rpb24pIHtcclxuICAgIGxldCB7ICRzbG90cywgJGxpc3RlbmVycywgdGFibGVQcm9wcyB9ID0gdGhpc1xyXG4gICAgcmV0dXJuIGgoJ3Z4ZS10YWJsZScsIHtcclxuICAgICAgY2xhc3M6ICd2eGUtZXhjZWwnLFxyXG4gICAgICBwcm9wczogdGFibGVQcm9wcyxcclxuICAgICAgb246IFhFVXRpbHMuYXNzaWduKHt9LCAkbGlzdGVuZXJzLCB7XHJcbiAgICAgICAgJ2NvbnRleHQtbWVudS1jbGljayc6IHRoaXMuY29udGV4dE1lbnVDbGlja0V2ZW50XHJcbiAgICAgIH0pLFxyXG4gICAgICByZWY6ICd4VGFibGUnXHJcbiAgICB9LCAkc2xvdHMuZGVmYXVsdClcclxuICB9LFxyXG4gIG1ldGhvZHM6IHtcclxuICAgIFtFWENFTF9NRVRIT0RTX05BTUUuQ09OVEVYVF9NRU5VX0NMSUNLX0VWRU5UXSAodGhpczogYW55LCB7IG1lbnUsIHJvdywgY29sdW1uIH06IGFueSwgZXZudDogYW55KSB7XHJcbiAgICAgIGxldCAkdGFibGUgPSB0aGlzLiRyZWZzLnhUYWJsZVxyXG4gICAgICBsZXQgeyBwcm9wZXJ0eSB9ID0gY29sdW1uXHJcbiAgICAgIHN3aXRjaCAobWVudS5jb2RlKSB7XHJcbiAgICAgICAgY2FzZSAnY2xpcCc6XHJcbiAgICAgICAgICAkdGFibGUuaGFuZGxlQ29weWVkKHRydWUsIGV2bnQpXHJcbiAgICAgICAgICBicmVha1xyXG4gICAgICAgIGNhc2UgJ2NvcHknOlxyXG4gICAgICAgICAgJHRhYmxlLmhhbmRsZUNvcHllZChmYWxzZSwgZXZudClcclxuICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgY2FzZSAncGFzdGUnOlxyXG4gICAgICAgICAgJHRhYmxlLmhhbmRsZVBhc3RlKGV2bnQpXHJcbiAgICAgICAgICBicmVha1xyXG4gICAgICAgIGNhc2UgJ2luc2VydCc6XHJcbiAgICAgICAgICAkdGFibGUuaW5zZXJ0QXQoe30sIHJvdylcclxuICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgY2FzZSAncmVtb3ZlJzpcclxuICAgICAgICAgICR0YWJsZS5yZW1vdmUocm93KVxyXG4gICAgICAgICAgYnJlYWtcclxuICAgICAgICBjYXNlICdjbGVhckRhdGEnOlxyXG4gICAgICAgICAgJHRhYmxlLmNsZWFyRGF0YShyb3csIHByb3BlcnR5KVxyXG4gICAgICAgICAgYnJlYWtcclxuICAgICAgICBjYXNlICdjbGVhckZpbHRlcic6XHJcbiAgICAgICAgICAkdGFibGUuY2xlYXJGaWx0ZXIoY29sdW1uKVxyXG4gICAgICAgICAgYnJlYWtcclxuICAgICAgICBjYXNlICdmaWx0ZXJTZWxlY3QnOlxyXG4gICAgICAgICAgJHRhYmxlLmZpbHRlcihwcm9wZXJ0eSlcclxuICAgICAgICAgICAgLnRoZW4oKG9wdGlvbnM6IEFycmF5PGFueT4pID0+IHtcclxuICAgICAgICAgICAgICBpZiAob3B0aW9ucy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIGxldCBvcHRpb24gPSBvcHRpb25zWzBdXHJcbiAgICAgICAgICAgICAgICBvcHRpb24uZGF0YSA9IFhFVXRpbHMuZ2V0KHJvdywgcHJvcGVydHkpXHJcbiAgICAgICAgICAgICAgICBvcHRpb24uY2hlY2tlZCA9IHRydWVcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pLnRoZW4oKCkgPT4gJHRhYmxlLnVwZGF0ZURhdGEoKSlcclxuICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgY2FzZSAnY2xlYXJTb3J0JzpcclxuICAgICAgICAgICR0YWJsZS5jbGVhclNvcnQoKVxyXG4gICAgICAgICAgYnJlYWtcclxuICAgICAgICBjYXNlICdzb3J0QXNjJzpcclxuICAgICAgICAgICR0YWJsZS5zb3J0KHByb3BlcnR5LCAnYXNjJylcclxuICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgY2FzZSAnc29ydERlc2MnOlxyXG4gICAgICAgICAgJHRhYmxlLnNvcnQocHJvcGVydHksICdkZXNjJylcclxuICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgY2FzZSAnZXhwb3J0QWxsJzpcclxuICAgICAgICAgICR0YWJsZS5leHBvcnRDc3YoeyBpc0hlYWRlcjogZmFsc2UgfSlcclxuICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgY2FzZSAnbWVyZ2UnOlxyXG4gICAgICAgICAgY29uc3QgeyBjb2x1bW5zLCByb3dzIH0gPSAkdGFibGUuZ2V0TW91c2VDaGVja2VkcygpXHJcbiAgICAgICAgICBjb25zdCB7IGNvbExpc3QsIHJvd0xpc3QgfSA9IHRoaXMubWVyZ2VTdG9yZVxyXG4gICAgICAgICAgaWYgKHJvd3MubGVuZ3RoICYmIGNvbHVtbnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHJvd3MuZm9yRWFjaCgocm93OiBhbnkpID0+IHJvd0xpc3QuaW5kZXhPZihyb3cpID09PSAtMSA/IHJvd0xpc3QucHVzaChyb3cpIDogMClcclxuICAgICAgICAgICAgY29sdW1ucy5mb3JFYWNoKChjb2x1bW46IGFueSkgPT4gY29sTGlzdC5pbmRleE9mKGNvbHVtbikgPT09IC0xID8gY29sTGlzdC5wdXNoKGNvbHVtbikgOiAwKVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgYnJlYWtcclxuICAgICAgfVxyXG4gICAgfSxcclxuICAgIFtFWENFTF9NRVRIT0RTX05BTUUuQ0VMTF9TUEFOX01FVEhPRF0gKHRoaXM6IGFueSwgcGFyYW1zOiBhbnkpIHtcclxuICAgICAgbGV0IHsgcm93LCAkcm93SW5kZXgsIGNvbHVtbiwgZGF0YSB9ID0gcGFyYW1zXHJcbiAgICAgIGNvbnN0IHsgY29sTGlzdCwgcm93TGlzdCB9ID0gdGhpcy5tZXJnZVN0b3JlXHJcbiAgICAgIGlmIChjb2xMaXN0LmluZGV4T2YoY29sdW1uKSA+IC0xKSB7XHJcbiAgICAgICAgbGV0IHByZXZSb3cgPSBkYXRhWyRyb3dJbmRleCAtIDFdXHJcbiAgICAgICAgbGV0IG5leHRSb3cgPSBkYXRhWyRyb3dJbmRleCArIDFdXHJcbiAgICAgICAgbGV0IGlzTWVyZ2VkID0gcm93TGlzdC5pbmRleE9mKHJvdykgPiAtMVxyXG4gICAgICAgIGlmIChwcmV2Um93ICYmIGlzTWVyZ2VkICYmIHJvd0xpc3QuaW5kZXhPZihwcmV2Um93KSA+IC0xKSB7XHJcbiAgICAgICAgICByZXR1cm4geyByb3dzcGFuOiAwLCBjb2xzcGFuOiAwIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgbGV0IGNvdW50Um93c3BhbiA9IDFcclxuICAgICAgICAgIGlmIChpc01lcmdlZCkge1xyXG4gICAgICAgICAgICB3aGlsZSAobmV4dFJvdyAmJiByb3dMaXN0LmluZGV4T2YobmV4dFJvdykgPiAtMSkge1xyXG4gICAgICAgICAgICAgIG5leHRSb3cgPSBkYXRhWysrY291bnRSb3dzcGFuICsgJHJvd0luZGV4XVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBpZiAoY291bnRSb3dzcGFuID4gMSkge1xyXG4gICAgICAgICAgICByZXR1cm4geyByb3dzcGFuOiBjb3VudFJvd3NwYW4sIGNvbHNwYW46IDEgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuY29uc3Qgcm93SGVpZ2h0OiBudW1iZXIgPSAyNFxyXG5cclxuaW50ZXJmYWNlIHBvc1JhbmdlRGF0YSB7XHJcbiAgdGV4dDogc3RyaW5nO1xyXG4gIHN0YXJ0OiBudW1iZXI7XHJcbiAgZW5kOiBudW1iZXI7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldEN1cnNvclBvc2l0aW9uICh0ZXh0YXJlYTogSFRNTFRleHRBcmVhRWxlbWVudCk6IHBvc1JhbmdlRGF0YSB7XHJcbiAgbGV0IHJhbmdlRGF0YTogcG9zUmFuZ2VEYXRhID0geyB0ZXh0OiAnJywgc3RhcnQ6IDAsIGVuZDogMCB9XHJcbiAgaWYgKHRleHRhcmVhLnNldFNlbGVjdGlvblJhbmdlKSB7XHJcbiAgICByYW5nZURhdGEuc3RhcnQgPSB0ZXh0YXJlYS5zZWxlY3Rpb25TdGFydFxyXG4gICAgcmFuZ2VEYXRhLmVuZCA9IHRleHRhcmVhLnNlbGVjdGlvbkVuZFxyXG4gIH1cclxuICByZXR1cm4gcmFuZ2VEYXRhXHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNldEN1cnNvclBvc2l0aW9uICh0ZXh0YXJlYTogSFRNTFRleHRBcmVhRWxlbWVudCwgcmFuZ2VEYXRhOiBwb3NSYW5nZURhdGEpIHtcclxuICBpZiAodGV4dGFyZWEuc2V0U2VsZWN0aW9uUmFuZ2UpIHtcclxuICAgIHRleHRhcmVhLmZvY3VzKClcclxuICAgIHRleHRhcmVhLnNldFNlbGVjdGlvblJhbmdlKHJhbmdlRGF0YS5zdGFydCwgcmFuZ2VEYXRhLmVuZClcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDmuLLmn5Plh73mlbBcclxuICovXHJcbmNvbnN0IHJlbmRlck1hcCA9IHtcclxuICBjZWxsOiB7XHJcbiAgICBhdXRvZm9jdXM6ICcudnhlLXRleHRhcmVhJyxcclxuICAgIHJlbmRlckVkaXQgKGg6IEZ1bmN0aW9uLCBlZGl0UmVuZGVyOiBhbnksIHBhcmFtczogYW55LCB7ICRleGNlbCB9OiBhbnkpIHtcclxuICAgICAgbGV0IHsgZXhjZWxTdG9yZSB9ID0gJGV4Y2VsXHJcbiAgICAgIGxldCB7IHVwbG9hZFJvd3MgfSA9IGV4Y2VsU3RvcmVcclxuICAgICAgbGV0IHsgcm93LCBjb2x1bW4gfSA9IHBhcmFtc1xyXG4gICAgICBsZXQgeyBtb2RlbCB9ID0gY29sdW1uXHJcbiAgICAgIHJldHVybiBbXHJcbiAgICAgICAgaCgnZGl2Jywge1xyXG4gICAgICAgICAgY2xhc3M6ICd2eGUtaW5wdXQtLXdyYXBwZXIgdnhlLWV4Y2VsLWNlbGwnLFxyXG4gICAgICAgICAgc3R5bGU6IHtcclxuICAgICAgICAgICAgaGVpZ2h0OiBgJHtjb2x1bW4ucmVuZGVySGVpZ2h0IC0gMX1weGBcclxuICAgICAgICAgIH1cclxuICAgICAgICB9LCBbXHJcbiAgICAgICAgICBoKCd0ZXh0YXJlYScsIHtcclxuICAgICAgICAgICAgY2xhc3M6ICd2eGUtdGV4dGFyZWEnLFxyXG4gICAgICAgICAgICBzdHlsZToge1xyXG4gICAgICAgICAgICAgIHdpZHRoOiBgJHtjb2x1bW4ucmVuZGVyV2lkdGh9cHhgXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGRvbVByb3BzOiB7XHJcbiAgICAgICAgICAgICAgdmFsdWU6IG1vZGVsLnZhbHVlXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG9uOiB7XHJcbiAgICAgICAgICAgICAgaW5wdXQgKGV2bnQ6IGFueSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IGlucEVsZW0gPSBldm50LnRhcmdldFxyXG4gICAgICAgICAgICAgICAgbW9kZWwudXBkYXRlID0gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgbW9kZWwudmFsdWUgPSBpbnBFbGVtLnZhbHVlXHJcbiAgICAgICAgICAgICAgICBpZiAoaW5wRWxlbS5zY3JvbGxIZWlnaHQgPiBpbnBFbGVtLm9mZnNldEhlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgICBpZiAodXBsb2FkUm93cy5pbmRleE9mKHJvdykgPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5wRWxlbS5zdHlsZS53aWR0aCA9IGAke2lucEVsZW0ub2Zmc2V0V2lkdGggKyAyMH1weGBcclxuICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpbnBFbGVtLnN0eWxlLmhlaWdodCA9IGAke2lucEVsZW0uc2Nyb2xsSGVpZ2h0fXB4YFxyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBjaGFuZ2UgKGV2bnQ6IGFueSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHVwbG9hZFJvd3MuaW5kZXhPZihyb3cpID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICB1cGxvYWRSb3dzLnB1c2gocm93KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAga2V5ZG93biAoZXZudDogYW55KSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgaW5wRWxlbSA9IGV2bnQudGFyZ2V0XHJcbiAgICAgICAgICAgICAgICBpZiAoZXZudC5hbHRLZXkgJiYgZXZudC5rZXlDb2RlID09PSAxMykge1xyXG4gICAgICAgICAgICAgICAgICBldm50LnByZXZlbnREZWZhdWx0KClcclxuICAgICAgICAgICAgICAgICAgZXZudC5zdG9wUHJvcGFnYXRpb24oKVxyXG4gICAgICAgICAgICAgICAgICBsZXQgcmFuZ2VEYXRhID0gZ2V0Q3Vyc29yUG9zaXRpb24oaW5wRWxlbSlcclxuICAgICAgICAgICAgICAgICAgbGV0IHBvcyA9IHJhbmdlRGF0YS5lbmRcclxuICAgICAgICAgICAgICAgICAgbGV0IGNlbGxWYWx1ZSA9IGlucEVsZW0udmFsdWVcclxuICAgICAgICAgICAgICAgICAgY2VsbFZhbHVlID0gYCR7Y2VsbFZhbHVlLnNsaWNlKDAsIHBvcyl9XFxuJHtjZWxsVmFsdWUuc2xpY2UocG9zLCBjZWxsVmFsdWUubGVuZ3RoKX1gXHJcbiAgICAgICAgICAgICAgICAgIGlucEVsZW0udmFsdWUgPSBjZWxsVmFsdWVcclxuICAgICAgICAgICAgICAgICAgbW9kZWwudXBkYXRlID0gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICBtb2RlbC52YWx1ZSA9IGNlbGxWYWx1ZVxyXG4gICAgICAgICAgICAgICAgICBpbnBFbGVtLnN0eWxlLmhlaWdodCA9IGAkeyhNYXRoLmZsb29yKGlucEVsZW0ub2Zmc2V0SGVpZ2h0IC8gcm93SGVpZ2h0KSArIDEpICogcm93SGVpZ2h0fXB4YFxyXG4gICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByYW5nZURhdGEuc3RhcnQgPSByYW5nZURhdGEuZW5kID0gKytwb3NcclxuICAgICAgICAgICAgICAgICAgICBzZXRDdXJzb3JQb3NpdGlvbihpbnBFbGVtLCByYW5nZURhdGEpXHJcbiAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgIF0pXHJcbiAgICAgIF1cclxuICAgIH0sXHJcbiAgICByZW5kZXJDZWxsIChoOiBGdW5jdGlvbiwgZWRpdFJlbmRlcjogYW55LCBwYXJhbXM6IGFueSkge1xyXG4gICAgICBsZXQgeyByb3csIGNvbHVtbiB9ID0gcGFyYW1zXHJcbiAgICAgIHJldHVybiBbXHJcbiAgICAgICAgaCgnc3BhbicsIHtcclxuICAgICAgICAgIGRvbVByb3BzOiB7XHJcbiAgICAgICAgICAgIGlubmVySFRNTDogWEVVdGlscy5lc2NhcGUoWEVVdGlscy5nZXQocm93LCBjb2x1bW4ucHJvcGVydHkpKS5yZXBsYWNlKC9cXG4vZywgJzxicj4nKVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgIF1cclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDln7rkuo4gdnhlLXRhYmxlIOihqOagvOeahOWinuW8uuaPkuS7tu+8jOWunueOsOeugOWNleeahCBFeGNlbCDooajmoLxcclxuICovXHJcbmV4cG9ydCBjb25zdCBWWEVUYWJsZVBsdWdpbkV4Y2VsID0ge1xyXG4gIGluc3RhbGwgKHh0YWJsZTogdHlwZW9mIFZYRVRhYmxlKSB7XHJcbiAgICBsZXQgeyBWdWUsIFRhYmxlLCByZW5kZXJlciwgdiB9ID0geHRhYmxlXHJcbiAgICBpZiAodiA9PT0gJ3YxJykge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1t2eGUtdGFibGUtcGx1Z2luLWV4Y2VsXSA+PSBWMiB2ZXJzaW9uIGlzIHJlcXVpcmVkLicpXHJcbiAgICB9XHJcbiAgICAvLyDnu6fmib8gVGFibGVcclxuICAgIFhFVXRpbHMuYXNzaWduKEV4Y2VsLnByb3BzLCBUYWJsZS5wcm9wcylcclxuICAgIFhFVXRpbHMuZWFjaChUYWJsZS5tZXRob2RzLCAoY2I6IEZ1bmN0aW9uLCBuYW1lOiBFWENFTF9NRVRIT0RTX05BTUUpID0+IHtcclxuICAgICAgRXhjZWwubWV0aG9kc1tuYW1lXSA9IGZ1bmN0aW9uICh0aGlzOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy4kcmVmcy54VGFibGVbbmFtZV0uYXBwbHkodGhpcy4kcmVmcy54VGFibGUsIGFyZ3VtZW50cylcclxuICAgICAgfVxyXG4gICAgfSlcclxuICAgIC8vIOa3u+WKoOWIsOa4suafk+WZqFxyXG4gICAgcmVuZGVyZXIubWl4aW4ocmVuZGVyTWFwKVxyXG4gICAgLy8g5rOo5YaM57uE5Lu2XHJcbiAgICBWdWUuY29tcG9uZW50KEV4Y2VsLm5hbWUsIEV4Y2VsKVxyXG4gIH1cclxufVxyXG5cclxuaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5WWEVUYWJsZSkge1xyXG4gIHdpbmRvdy5WWEVUYWJsZS51c2UoVlhFVGFibGVQbHVnaW5FeGNlbClcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgVlhFVGFibGVQbHVnaW5FeGNlbFxyXG4iXX0=
